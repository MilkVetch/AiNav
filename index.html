<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="pageTitle">网址导航</title>
    <link rel="stylesheet" href="style.css">
</head>
<body class="theme-classic">

    <div class="bg-glow" id="bgGlow"></div>

    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand" onclick="confirmReset()">
                <span id="navBrandText">网址导航</span>
                <div id="statusClickArea" title="点击断开连接">
                    <span id="syncStatus" class="status-dot"></span>
                </div>
            </div>
            
            <div class="nav-actions">
                <button id="addSiteBtn" class="glass-btn hide" onclick="openCustomModal('siteModal')">+ 网址</button>
                <button id="addCatBtn" class="glass-btn hide" onclick="openCustomModal('catModal')">+ 分类</button>
                <button class="glass-btn primary" onclick="handleOpenSettings()">
                    <i data-lucide="settings" class="icon-sm"></i> <span>设置</span>
                </button>
            </div>
        </div>
    </nav>

    <main class="content-wrapper">
        <header class="hero-section">
            <h1 id="digitalClock">00:00</h1>
            <p id="greetingText">正在准备...</p>
            <div class="search-bar">
                <i data-lucide="search"></i>
                <input type="text" id="searchInput" placeholder="搜索或输入网址..." onkeypress="handleSearch(event)">
            </div>
        </header>

        <div id="app">
            <div class="loading-state">
                <div class="spinner"></div>
                <p>同步中...</p>
            </div>
        </div>
    </main>

    <footer class="footer">
        © 2025 Khee. Crafted with ♥ for AI lovers.
    </footer>

    <div class="custom-overlay" id="modalOverlay" onclick="closeAllModals()"></div>

    <div class="custom-modal" id="settingsModal">
        <div class="modal-header">
            <h3>系统设置</h3>
            <button class="close-btn" onclick="closeAllModals()">&times;</button>
        </div>
        <div class="modal-body">
            <div class="collapsible-section hide" id="boardSettingItem">
                <div class="collapsible-header" onclick="toggleSection('collapseBoards')">
                    <span>面板设置</span> <i data-lucide="layers" class="icon-sm"></i>
                </div>
                <div class="collapsible-content" id="collapseBoards">
                    <label class="field-label">切换面板</label>
                    <select id="boardSwitcher" class="custom-select" onchange="switchBoard(this.value)"></select>
                    <label class="field-label">面板更名</label>
                    <div class="input-group">
                        <input type="text" id="siteTitleInput" class="custom-input">
                        <button class="action-btn-small" onclick="renameBoard()">应用</button>
                    </div>
                    <div class="btn-row">
                        <button class="action-btn success" onclick="createNewBoard()">+ 新增</button>
                        <button class="action-btn danger" onclick="deleteCurrentBoard()">删除</button>
                    </div>
                </div>
            </div>

            <div class="collapsible-section hide" id="themeSettingItem">
                <div class="collapsible-header" onclick="toggleSection('collapseThemes')">
                    <span>配色方案</span> <i data-lucide="palette" class="icon-sm"></i>
                </div>
                <div class="collapsible-content" id="collapseThemes">
                    <div class="theme-grid" id="themeList"></div>
                </div>
            </div>

            <div class="collapsible-section active" id="backendSettingItem">
                <div class="collapsible-header" onclick="toggleSection('collapseBackend')">
                    <span>后端配置 (Gist)</span> <i data-lucide="database" class="icon-sm"></i>
                </div>
                <div class="collapsible-content" id="collapseBackend" style="display: block;">
                    <div class="input-field">
                        <label>GitHub Token</label>
                        <input type="password" id="ghToken" class="custom-input">
                    </div>
                    <div class="input-field">
                        <label>Gist ID</label>
                        <input type="text" id="gistId" class="custom-input">
                    </div>
                    <button class="save-btn" onclick="saveSettings()">连接并保存</button>
                </div>
            </div>
        </div>
    </div>

    <div class="custom-modal" id="siteModal">
        <div class="modal-header"><h3>新增网址</h3><button class="close-btn" onclick="closeAllModals()">&times;</button></div>
        <div class="modal-body">
            <div class="input-field"><label>选择分类</label><select id="targetCat" class="custom-select"></select></div>
            <div class="input-field"><label>名称</label><input type="text" id="siteName" class="custom-input"></div>
            <div class="input-field"><label>网址</label><input type="text" id="siteUrl" class="custom-input" placeholder="www.google.com"></div>
            <button class="save-btn" onclick="addItem()">确认添加</button>
        </div>
    </div>

    <div class="custom-modal" id="catModal">
        <div class="modal-header"><h3>新增分类</h3><button class="close-btn" onclick="closeAllModals()">&times;</button></div>
        <div class="modal-body">
            <div class="input-field"><label>分类名称</label><input type="text" id="catName" class="custom-input"></div>
            <button class="save-btn" onclick="addCategory()">确认添加</button>
        </div>
    </div>

    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="script.js"></script>
</body>
</html>